{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import section1Image from'../assets/imgs/carrousel_img_1.jpg';import section2Image from'../assets/imgs/carrousel_img_2.jpg';import section3Image from'../assets/imgs/carrousel_img_3.jpg';import{jsx as _jsx}from\"react/jsx-runtime\";const sectionImages=[section1Image,section2Image,section3Image];const NUM_STRIPS=20;const ANIMATION_DURATION=500;const STRIP_DELAY=30;const START_ROW=0;const HomeCarousel=_ref=>{let{section}=_ref;const canvasRef=useRef(null);const[image,setImage]=useState(null);const animationRef=useRef(null);const stripsProgress=useRef(Array(NUM_STRIPS).fill(0));const isAnimating=useRef(false);// Cargar imagen actual\nuseEffect(()=>{const img=new Image();img.src=sectionImages[section];img.onload=()=>{setImage(img);drawInitialState();};img.onerror=e=>console.error('Error loading image:',e);},[section]);const drawInitialState=()=>{var _canvasRef$current;const ctx=(_canvasRef$current=canvasRef.current)===null||_canvasRef$current===void 0?void 0:_canvasRef$current.getContext('2d');if(!ctx)return;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);stripsProgress.current=Array(NUM_STRIPS).fill(0);drawImage(ctx);};// Configurar canvas\nuseEffect(()=>{if(!image)return;const canvas=canvasRef.current;const ctx=canvas.getContext('2d',{willReadFrequently:true,alpha:true});ctx.imageSmoothingEnabled=true;ctx.imageSmoothingQuality='auto';const container=canvas.parentElement;const setCanvasSize=()=>{canvas.width=container.clientWidth*2;canvas.height=container.clientHeight*2;canvas.style.width=`${container.clientWidth}px`;canvas.style.height=`${container.clientHeight}px`;};setCanvasSize();drawImage(ctx);const resizeObserver=new ResizeObserver(setCanvasSize);resizeObserver.observe(container);return()=>{resizeObserver.disconnect();cancelAnimationFrame(animationRef.current);};},[image]);const drawImage=ctx=>{if(!image||!ctx)return;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);// Dibujar fondo transparente\nctx.fillStyle='transparent';ctx.fillRect(0,0,ctx.canvas.width,ctx.canvas.height);// Calcular stripWidth como número entero\nconst stripWidth=Math.ceil(ctx.canvas.width/NUM_STRIPS);// Ajustar el ancho total para evitar desbordamiento\nconst totalWidth=stripWidth*NUM_STRIPS;const xOffset=Math.max(0,(ctx.canvas.width-totalWidth)/2);stripsProgress.current.forEach((progress,index)=>{ctx.save();// Calcular posición X como número entero\nconst xPos=Math.floor(xOffset+index*stripWidth);// Ancho de revelación sin espacios\nconst revealWidth=Math.ceil(stripWidth*progress);// Crear máscara de recorte ajustada\nctx.beginPath();ctx.rect(xPos,0,revealWidth,ctx.canvas.height);ctx.clip();// Dibujar porción de la imagen con alineación perfecta\nctx.drawImage(image,Math.floor(index*image.width/NUM_STRIPS),// Source X\n0,// Source Y\nMath.ceil(image.width/NUM_STRIPS),// Source width\nimage.height,// Source height\nxPos,// Dest X\n0,// Dest Y\nstripWidth,// Dest width\nctx.canvas.height// Dest height\n);ctx.restore();});};const startAnimation=()=>{if(isAnimating.current)return;isAnimating.current=true;const animate=startTime=>{var _canvasRef$current2;const ctx=(_canvasRef$current2=canvasRef.current)===null||_canvasRef$current2===void 0?void 0:_canvasRef$current2.getContext('2d');if(!ctx)return;stripsProgress.current=stripsProgress.current.map((_,index)=>{const elapsed=performance.now()-startTime-index*STRIP_DELAY;const rawProgress=Math.min(elapsed/ANIMATION_DURATION,1);// Easing cúbico para efecto de desaceleración\nreturn 1-Math.pow(1-rawProgress,3);});drawImage(ctx);if(performance.now()-startTime<NUM_STRIPS*STRIP_DELAY+ANIMATION_DURATION){animationRef.current=requestAnimationFrame(()=>animate(startTime));}else{isAnimating.current=false;// Forzar estado final completo\nstripsProgress.current=Array(NUM_STRIPS).fill(1);drawImage(ctx);}};animationRef.current=requestAnimationFrame(()=>animate(performance.now()));};return/*#__PURE__*/_jsx(\"div\",{className:\"home__carrousel\",onClick:startAnimation,style:{position:'relative',cursor:'pointer',background:'transparent',mixBlendMode:'multiply'},children:/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{background:'transparent',imageRendering:'auto'}})});};export default HomeCarousel;","map":{"version":3,"names":["React","useEffect","useRef","useState","section1Image","section2Image","section3Image","jsx","_jsx","sectionImages","NUM_STRIPS","ANIMATION_DURATION","STRIP_DELAY","START_ROW","HomeCarousel","_ref","section","canvasRef","image","setImage","animationRef","stripsProgress","Array","fill","isAnimating","img","Image","src","onload","drawInitialState","onerror","e","console","error","_canvasRef$current","ctx","current","getContext","clearRect","canvas","width","height","drawImage","willReadFrequently","alpha","imageSmoothingEnabled","imageSmoothingQuality","container","parentElement","setCanvasSize","clientWidth","clientHeight","style","resizeObserver","ResizeObserver","observe","disconnect","cancelAnimationFrame","fillStyle","fillRect","stripWidth","Math","ceil","totalWidth","xOffset","max","forEach","progress","index","save","xPos","floor","revealWidth","beginPath","rect","clip","restore","startAnimation","animate","startTime","_canvasRef$current2","map","_","elapsed","performance","now","rawProgress","min","pow","requestAnimationFrame","className","onClick","position","cursor","background","mixBlendMode","children","ref","imageRendering"],"sources":["/home/johnlemon/portfolio/src/components/HomeCarousel.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport section1Image from '../assets/imgs/carrousel_img_1.jpg';\nimport section2Image from '../assets/imgs/carrousel_img_2.jpg';\nimport section3Image from '../assets/imgs/carrousel_img_3.jpg';\n\nconst sectionImages = [section1Image, section2Image, section3Image];\nconst NUM_STRIPS = 20;\nconst ANIMATION_DURATION = 500;\nconst STRIP_DELAY = 30;\nconst START_ROW = 0;\n\nconst HomeCarousel = ({ section }) => {\n  const canvasRef = useRef(null);\n  const [image, setImage] = useState(null);\n  const animationRef = useRef(null);\n  const stripsProgress = useRef(Array(NUM_STRIPS).fill(0));\n  const isAnimating = useRef(false);\n\n  // Cargar imagen actual\n  useEffect(() => {\n    const img = new Image();\n    img.src = sectionImages[section];\n    img.onload = () => {\n      setImage(img);\n      drawInitialState();\n    };\n    img.onerror = (e) => console.error('Error loading image:', e);\n  }, [section]);\n\n  const drawInitialState = () => {\n    const ctx = canvasRef.current?.getContext('2d');\n    if (!ctx) return;\n\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    stripsProgress.current = Array(NUM_STRIPS).fill(0);\n    drawImage(ctx);\n  };\n\n  // Configurar canvas\n  useEffect(() => {\n    if (!image) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d', { \n      willReadFrequently: true,\n      alpha: true\n    });\n    \n    ctx.imageSmoothingEnabled = true;\n    ctx.imageSmoothingQuality = 'auto';\n\n    const container = canvas.parentElement;\n    \n    const setCanvasSize = () => {\n      canvas.width = container.clientWidth * 2;\n      canvas.height = container.clientHeight * 2;\n      canvas.style.width = `${container.clientWidth}px`;\n      canvas.style.height = `${container.clientHeight}px`;\n    };\n\n    setCanvasSize();\n    drawImage(ctx);\n\n    const resizeObserver = new ResizeObserver(setCanvasSize);\n    resizeObserver.observe(container);\n\n    return () => {\n      resizeObserver.disconnect();\n      cancelAnimationFrame(animationRef.current);\n    };\n  }, [image]);\n\n  const drawImage = (ctx) => {\n    if (!image || !ctx) return;\n\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    \n    // Dibujar fondo transparente\n    ctx.fillStyle = 'transparent';\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    \n    // Calcular stripWidth como número entero\n    const stripWidth = Math.ceil(ctx.canvas.width / NUM_STRIPS);\n    \n    // Ajustar el ancho total para evitar desbordamiento\n    const totalWidth = stripWidth * NUM_STRIPS;\n    const xOffset = Math.max(0, (ctx.canvas.width - totalWidth) / 2);\n\n    stripsProgress.current.forEach((progress, index) => {\n        ctx.save();\n        \n        // Calcular posición X como número entero\n        const xPos = Math.floor(xOffset + index * stripWidth);\n        \n        // Ancho de revelación sin espacios\n        const revealWidth = Math.ceil(stripWidth * progress);\n\n        // Crear máscara de recorte ajustada\n        ctx.beginPath();\n        ctx.rect(\n            xPos,\n            0,\n            revealWidth,\n            ctx.canvas.height\n        );\n        ctx.clip();\n        \n        // Dibujar porción de la imagen con alineación perfecta\n        ctx.drawImage(\n            image,\n            Math.floor((index * image.width) / NUM_STRIPS), // Source X\n            0, // Source Y\n            Math.ceil(image.width / NUM_STRIPS), // Source width\n            image.height, // Source height\n            xPos, // Dest X\n            0, // Dest Y\n            stripWidth, // Dest width\n            ctx.canvas.height // Dest height\n        );\n        \n        ctx.restore();\n    });\n};\n\n  const startAnimation = () => {\n    if (isAnimating.current) return;\n    isAnimating.current = true;\n\n    const animate = (startTime) => {\n      const ctx = canvasRef.current?.getContext('2d');\n      if (!ctx) return;\n\n      stripsProgress.current = stripsProgress.current.map((_, index) => {\n        const elapsed = performance.now() - startTime - (index * STRIP_DELAY);\n        const rawProgress = Math.min(elapsed / ANIMATION_DURATION, 1);\n        \n        // Easing cúbico para efecto de desaceleración\n        return 1 - Math.pow(1 - rawProgress, 3);\n      });\n\n      drawImage(ctx);\n\n      if (performance.now() - startTime < (NUM_STRIPS * STRIP_DELAY) + ANIMATION_DURATION) {\n        animationRef.current = requestAnimationFrame(() => animate(startTime));\n      } else {\n        isAnimating.current = false;\n        // Forzar estado final completo\n        stripsProgress.current = Array(NUM_STRIPS).fill(1);\n        drawImage(ctx);\n      }\n    };\n\n    animationRef.current = requestAnimationFrame(() => animate(performance.now()));\n  };\n\n  return (\n    <div \n      className=\"home__carrousel\" \n      onClick={startAnimation}\n      style={{ \n        position: 'relative',\n        cursor: 'pointer',\n        background: 'transparent',\n        mixBlendMode: 'multiply'\n      }}\n    >\n      <canvas \n        ref={canvasRef}\n        style={{ \n          background: 'transparent',\n          imageRendering: 'auto'\n        }}\n      />\n    </div>\n  );\n};\n\nexport default HomeCarousel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}